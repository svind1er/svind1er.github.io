<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ubalansert | Ocean Writeups</title>
    <meta name="description" content="Exploit unbalanced RSA primes with Pollard&#39;s Rho." />
    <link rel="stylesheet" href="/assets/styles.css?v=1769475129562.6333" />
    <link rel="stylesheet" href="/assets/prism.css?v=1769465093475.447" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    />
  </head>
  <body>
    <div class="page-bg"></div>
    <header class="site-header" aria-hidden="true"></header>
    <main class="container">
      <article class="post glass">
  <a href="/#writeups" class="back-link">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path
        d="M15 6l-6 6 6 6"
        fill="none"
        stroke="currentColor"
        stroke-width="1.5"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
    </svg>
    Back to writeups
  </a>
  <header class="post-header">
    <p class="eyebrow">Writeup</p>
    <h1>Ubalansert</h1>
    <div class="post-meta">
      <span>Jan 27, 2025</span>
      
      <span class="meta-pill">Cryptography</span>
      
      
      <span class="meta-pill">Easy</span>
      
      
      <div class="tag-row">
        
        <span class="meta-pill">ETJ2025</span>
        
      </div>
      
    </div>
  </header>
  <div class="post-content prose">
    <h2>Analysis</h2>
<p>The challenge hint, &quot;Everything is not as balanced as it seems,&quot; suggests a flaw in the prime generation. In RSA, the modulus <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\large n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">n</span></span></span></span></eq> is the product of two primes, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\large p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7">p</span></span></span></span></eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>q</mi></mstyle></mrow><annotation encoding="application/x-tex">\large q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7" style="margin-right:0.03588em;">q</span></span></span></span></eq>. For maximum security, these should have the same bit-length. An &quot;imbalance&quot; indicates that one prime is much smaller than the other.</p>
<h2>Vulnerability</h2>
<p>If the prime factors are unbalanced, the modulus <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\large n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">n</span></span></span></span></eq> becomes vulnerable to <strong>Pollard's Rho algorithm</strong>. While secure RSA requires factoring <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\large n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">n</span></span></span></span></eq> to be computationally infeasible, Rhos method can find a small factor <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\large p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7">p</span></span></span></span></eq> in approximately <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>O</mi><mo stretchy="false">(</mo><msqrt><mi>p</mi></msqrt><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large O(\sqrt{p})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3043em;vertical-align:-0.4043em;"></span><span class="mord mathnormal sizing reset-size6 size7" style="margin-right:0.02778em;">O</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sqrt sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7031em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">p</span></span></span><span style="top:-2.8631em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3369em;"><span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></eq> steps. Once the small prime is found, the entire RSA cryptosystem collapses.</p>
<h2>Exploitation</h2>
<p>The attack was executed using the following mathematical steps:</p>
<ol>
<li><strong>Factorization</strong>: Rhos method was used to find <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\large p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7">p</span></span></span></span></eq>. The second prime was then found via: <section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="2.074em"><mi>q</mi><mo>=</mo><mfrac><mi>n</mi><mi>p</mi></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\huge q = \frac{n}{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2962em;vertical-align:-0.4033em;"></span><span class="mord mathnormal sizing reset-size6 size10" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size10">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.1231em;vertical-align:-1.826em;"></span><span class="mord sizing reset-size6 size10"><span class="mopen nulldelimiter sizing reset-size10 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-3.388em;"><span class="pstrut" style="height:4.074em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-4.304em;"><span class="pstrut" style="height:4.074em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.751em;"><span class="pstrut" style="height:4.074em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size10 size6"></span></span></span></span></span></span></eqn></section></li>
<li><strong>Totient Calculation</strong>: The Euler's totient function was calculated: <section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="2.074em"><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\huge \phi(n) = (p - 1)(q - 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mord mathnormal sizing reset-size6 size10">ϕ</span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10">n</span><span class="mclose sizing reset-size6 size10">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size10">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin sizing reset-size6 size10">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mord sizing reset-size6 size10">1</span><span class="mclose sizing reset-size6 size10">)</span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin sizing reset-size6 size10">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mord sizing reset-size6 size10">1</span><span class="mclose sizing reset-size6 size10">)</span></span></span></span></span></eqn></section></li>
<li><strong>Private Key Derivation</strong>: The private exponent <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>d</mi></mstyle></mrow><annotation encoding="application/x-tex">\large d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;"></span><span class="mord mathnormal sizing reset-size6 size7">d</span></span></span></span></eq> was calculated as the modular multiplicative inverse of <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>e</mi></mstyle></mrow><annotation encoding="application/x-tex">\large e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">e</span></span></span></span></eq> modulo <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large \phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em;"></span><span class="mord mathnormal sizing reset-size6 size7">ϕ</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathnormal sizing reset-size6 size7">n</span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></eq>: <section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="2.074em"><mi>d</mi><mo>≡</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\huge d \equiv e^{-1} \pmod{\phi(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4403em;"></span><span class="mord mathnormal sizing reset-size6 size10">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size10">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7846em;"></span><span class="mord sizing reset-size6 size10"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8604em;"><span style="top:-3.853em;margin-right:0.0241em;"><span class="pstrut" style="height:3.44em;"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak sizing reset-size6 size10"></span><span class="mspace sizing reset-size6 size10" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace sizing reset-size6 size10" style="margin-right:0.3333em;"></span><span class="mord mathnormal sizing reset-size6 size10">ϕ</span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10">n</span><span class="mclose sizing reset-size6 size10">))</span></span></span></span></span></eqn></section></li>
<li><strong>Decryption</strong>: The ciphertext <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>c</mi></mstyle></mrow><annotation encoding="application/x-tex">\large c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">c</span></span></span></span></eq> was decrypted to find the message <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>m</mi></mstyle></mrow><annotation encoding="application/x-tex">\large m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">m</span></span></span></span></eq>: <section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="2.074em"><mi>m</mi><mo>≡</mo><msup><mi>c</mi><mi>d</mi></msup><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>n</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\huge m \equiv c^d \pmod{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9618em;"></span><span class="mord mathnormal sizing reset-size6 size10">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size10">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8566em;"></span><span class="mord sizing reset-size6 size10"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8952em;"><span style="top:-3.853em;margin-right:0.0241em;"><span class="pstrut" style="height:3.44em;"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace allowbreak sizing reset-size6 size10"></span><span class="mspace sizing reset-size6 size10" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace sizing reset-size6 size10" style="margin-right:0.3333em;"></span><span class="mord mathnormal sizing reset-size6 size10">n</span><span class="mclose sizing reset-size6 size10">)</span></span></span></span></span></eqn></section></li>
<li><strong>Decoding</strong>: The integer <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>m</mi></mstyle></mrow><annotation encoding="application/x-tex">\large m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">m</span></span></span></span></eq> was converted to ASCII to reveal the flag.</li>
</ol>
<h2>Challenge</h2>
<p><strong>1. Input Values:</strong></p>
<ul>
<li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>n</mi><mo>=</mo><mn>121177..3877</mn></mstyle></mrow><annotation encoding="application/x-tex">\large n = 121177..3877</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7733em;"></span><span class="mord sizing reset-size6 size7">121177..3877</span></span></span></span></eq></li>
<li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>e</mi><mo>=</mo><mn>65537</mn></mstyle></mrow><annotation encoding="application/x-tex">\large e = 65537</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7733em;"></span><span class="mord sizing reset-size6 size7">65537</span></span></span></span></eq></li>
<li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>c</mi><mo>=</mo><mn>136485..650</mn></mstyle></mrow><annotation encoding="application/x-tex">\large c = 136485..650</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7733em;"></span><span class="mord sizing reset-size6 size7">136485..650</span></span></span></span></eq></li>
</ul>
<p><strong>2. Factorization (Finding <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\large p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7">p</span></span></span></span></eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>q</mi></mstyle></mrow><annotation encoding="application/x-tex">\large q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7" style="margin-right:0.03588em;">q</span></span></span></span></eq>):</strong><br>
Since <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\large n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">n</span></span></span></span></eq> has a small factor, Rhos method was used to extract it. This algorithm is efficient because its complexity depends on the size of the smallest factor rather than the total size of <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\large n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">n</span></span></span></span></eq>.</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">import</span> gmpy2

<span class="token keyword">def</span> <span class="token function">pollards_rho</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> d<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span>
    f <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> c<span class="token punctuation">)</span> <span class="token operator">%</span> n
    <span class="token keyword">while</span> d <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> f<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        y <span class="token operator">=</span> f<span class="token punctuation">(</span>f<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>x <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">return</span> d

p <span class="token operator">=</span> pollards_rho<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
q <span class="token operator">=</span> n <span class="token operator">//</span> p</code></pre>
<p><strong>3. Factored Results:</strong><br>
The script successfully split the modulus <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\large n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">n</span></span></span></span></eq> into:</p>
<ul>
<li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>p</mi><mo>=</mo><mn>4368083</mn></mstyle></mrow><annotation encoding="application/x-tex">\large p = 4368083</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7733em;"></span><span class="mord sizing reset-size6 size7">4368083</span></span></span></span></eq> (approx. <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mn>22</mn></mstyle></mrow><annotation encoding="application/x-tex">\large 22</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7733em;"></span><span class="mord sizing reset-size6 size7">22</span></span></span></span></eq> bits)</li>
<li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>q</mi><mo>=</mo><mn>73725722...6669683</mn></mstyle></mrow><annotation encoding="application/x-tex">\large q = 73725722...6669683</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7733em;"></span><span class="mord sizing reset-size6 size7">73725722...6669683</span></span></span></span></eq> (approx. <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mn>2048</mn></mstyle></mrow><annotation encoding="application/x-tex">\large 2048</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7733em;"></span><span class="mord sizing reset-size6 size7">2048</span></span></span></span></eq> bits)</li>
</ul>
<p><strong>4. The Imbalance:</strong><br>
The security failure is caused by the massive gap in bit-length: <section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="2.074em"><mtext>Bit-length</mtext><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>≫</mo><mtext>Bit-length</mtext><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\huge \text{Bit-length}(q) \gg \text{Bit-length}(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mord text sizing reset-size6 size10"><span class="mord">Bit-length</span></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10" style="margin-right:0.03588em;">q</span><span class="mclose sizing reset-size6 size10">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size10">≫</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mord text sizing reset-size6 size10"><span class="mord">Bit-length</span></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10">p</span><span class="mclose sizing reset-size6 size10">)</span></span></span></span></span></eqn></section>In a secure RSA setup, both primes should be roughly 1024 bits each. Here, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\large p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7">p</span></span></span></span></eq> is so small that it can be found in a fraction of a second. The total 2048-bit length of <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\large n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5167em;"></span><span class="mord mathnormal sizing reset-size6 size7">n</span></span></span></span></eq> provides a false sense of security because the difficulty of factoring it is tied only to the smallest factor, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\large p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7">p</span></span></span></span></eq>.</p>
<p><strong>5. Recovery of Plaintext:</strong><br>
Once you have <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\large p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7">p</span></span></span></span></eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mi>q</mi></mstyle></mrow><annotation encoding="application/x-tex">\large q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.2333em;"></span><span class="mord mathnormal sizing reset-size6 size7" style="margin-right:0.03588em;">q</span></span></span></span></eq>, you can bypass the security of the modulus. The following Python snippet calculates the private exponent and decodes the message:</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># 1. Calculate the totient (phi)</span>
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 2. Calculate the private key d (modular inverse of e mod phi)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>

<span class="token comment"># 3. Decrypt the ciphertext c</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token comment"># 4. Convert the large integer m back to readable text</span>
<span class="token comment"># We use 'big' because RSA integers are stored in big-endian format</span>
byte_length <span class="token operator">=</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">8</span>
flag <span class="token operator">=</span> m<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>byte_length<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Decrypted Flag: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre>
<h2>Summary</h2>
<p>To get from the factors to the flag, the logic follows these steps:</p>
<ol>
<li><strong>The Totient:</strong> <section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="2.074em"><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\huge \phi(n) = (p - 1)(q - 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mord mathnormal sizing reset-size6 size10">ϕ</span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10">n</span><span class="mclose sizing reset-size6 size10">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size10">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin sizing reset-size6 size10">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mord sizing reset-size6 size10">1</span><span class="mclose sizing reset-size6 size10">)</span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin sizing reset-size6 size10">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mord sizing reset-size6 size10">1</span><span class="mclose sizing reset-size6 size10">)</span></span></span></span></span></eqn></section></li>
<li><strong>The Private Key:</strong> <section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="2.074em"><mi>d</mi><mo>⋅</mo><mi>e</mi><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\huge d \cdot e \equiv 1 \pmod{\phi(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4403em;"></span><span class="mord mathnormal sizing reset-size6 size10">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin sizing reset-size6 size10">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9618em;"></span><span class="mord mathnormal sizing reset-size6 size10">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size10">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3366em;"></span><span class="mord sizing reset-size6 size10">1</span><span class="mspace allowbreak sizing reset-size6 size10"></span><span class="mspace sizing reset-size6 size10" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace sizing reset-size6 size10" style="margin-right:0.3333em;"></span><span class="mord mathnormal sizing reset-size6 size10">ϕ</span><span class="mopen sizing reset-size6 size10">(</span><span class="mord mathnormal sizing reset-size6 size10">n</span><span class="mclose sizing reset-size6 size10">))</span></span></span></span></span></eqn></section></li>
<li><strong>The Decryption:</strong> <section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="2.074em"><mi>m</mi><mo>≡</mo><msup><mi>c</mi><mi>d</mi></msup><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>n</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\huge m \equiv c^d \pmod{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9618em;"></span><span class="mord mathnormal sizing reset-size6 size10">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size10">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8566em;"></span><span class="mord sizing reset-size6 size10"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8952em;"><span style="top:-3.853em;margin-right:0.0241em;"><span class="pstrut" style="height:3.44em;"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace allowbreak sizing reset-size6 size10"></span><span class="mspace sizing reset-size6 size10" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em;"></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace sizing reset-size6 size10" style="margin-right:0.3333em;"></span><span class="mord mathnormal sizing reset-size6 size10">n</span><span class="mclose sizing reset-size6 size10">)</span></span></span></span></span></eqn></section></li>
</ol>
<h2>Solution</h2>
<pre class="language-python"><code class="language-python"><span class="token keyword">import</span> gmpy2

n <span class="token operator">=</span> <span class="token number">3220400754238202061781251914995435264732318174482765169331795884593241326420375704675214035152827573720388930809775261470702050758691213422440413562439642865949407161085588489381043681376138238326586665459068025141951028342701397020830706271636407958209373133213710382252444824049984463278729298760773532084799000984604307841825788741782578493919696881862922264915324501250081383327000337481958850284409366488681648360821860708683512450374639594476105658596779781478405295536908596351242954075566616141514156783587173290655774002039564408387248272551248596876508900652920852722789212661920752164966732033945824631479680913085674104670989014941975529785913063075103912888366495312714026942383075130726822265897500715653901796315699488862004310020306153676480356656088986856936102005370890342215440452697160076270658509898876927688964856675456856842317740759318302246005614389024793338548424770232444248537017039529996717078474887543013787998901743028948016218257849692865136536693308631721782283990062011595162755424987194202154750195755945475504871394590719516755292274764625302653697743473172993534825500491806864146833441837634172573568106988482202046818059132212238473594476747343716231335798867398016744056607423864108747252761308927689</span>
e <span class="token operator">=</span> <span class="token number">65537</span>
c <span class="token operator">=</span> <span class="token number">1422753909948395314646006472071254361532630325250368813541948964201446802143155132895264260394616371614846584545966664514222434444977999340373884455836663809084067020913246159470418600871024118551826323293836349720409047353535936125979966123258624540348333885255448580865109191443183740046237276637974965190322691920400270785273951737405071605888358871471785310665656382456856081509253179421415649984191431649774414201066746199351922703357373475506848925939679021227847405889897652008092943482933180318265072346450338965177459143920248638012339176290751780733735968297859795949400403196371556866214892960754383543485233611884729186779459506788535464939499893268696584240053265373159550526364216287786443680335759372755202259341301843491663886728062956331758909676211337903338883251410564958813757661036016935759093830497797621284302942258820994808155797372953101586129779205708730478923897953236800065495588983902682741975848274664776247534755446017834050517343816840870021865156773538993828460708433992818383336024152253829195071237053302254491474515282627091277303838787290205584935460731148951562919350237691151203215177985174318125193262644277451610279023478863560822577085725322180650626735193397641058822629584593311352682719764458890</span>

<span class="token keyword">def</span> <span class="token function">pollards_rho</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> d<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span>
    f <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> c<span class="token punctuation">)</span> <span class="token operator">%</span> n
    <span class="token keyword">while</span> d <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> f<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        y <span class="token operator">=</span> f<span class="token punctuation">(</span>f<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>x <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">return</span> d

p <span class="token operator">=</span> pollards_rho<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
q <span class="token operator">=</span> n <span class="token operator">//</span> p

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"p = </span><span class="token interpolation"><span class="token punctuation">{</span>p<span class="token punctuation">}</span></span><span class="token string"> \n q = </span><span class="token interpolation"><span class="token punctuation">{</span>q<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>

m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

blength <span class="token operator">=</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">8</span>
flag <span class="token operator">=</span> m<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>blength<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"flag: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre>

  </div>
</article>
<script>
  window.addEventListener("keydown", (event) => {
    if (event.key === "Escape") {
      window.location.href = "/#writeups";
    }
  });
</script>

    </main>
  </body>
</html>
