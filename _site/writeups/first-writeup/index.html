<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Crypto 101: One-Time Pad Reuse | Ocean Writeups</title>
    <meta name="description" content="A short walk-through showing why OTP reuse leaks plaintext." />
    <link rel="stylesheet" href="/assets/styles.css" />
    <link rel="stylesheet" href="/assets/prism.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    />
  </head>
  <body>
    <div class="page-bg"></div>
    <header class="site-header" aria-hidden="true"></header>
    <main class="container">
      <article class="post glass">
  <a href="/#writeups" class="back-link">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path
        d="M15 6l-6 6 6 6"
        fill="none"
        stroke="currentColor"
        stroke-width="1.5"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
    </svg>
    Back to writeups
  </a>
  <header class="post-header">
    <p class="eyebrow">Writeup</p>
    <h1>Crypto 101: One-Time Pad Reuse</h1>
    <div class="post-meta">
      <span>May 12, 2024</span>
      
      <span class="meta-pill">Crypto</span>
      
      
      <span class="meta-pill">Easy</span>
      
      
      <div class="tag-row">
        
        <span class="meta-pill">HTB</span>
        
      </div>
      
    </div>
  </header>
  <div class="post-content prose">
    <p>This writeup is a short sketch of a classic CTF crypto mistake: reusing a one-time pad.</p>
<h2>Quick intuition</h2>
<p>If two ciphertexts share the same OTP key, XORing them removes the key and leaves
the XOR of the two plaintexts.</p>
<p>Inline math example: $C_1 \oplus C_2 = P_1 \oplus P_2$.</p>
<p>Block math example:</p>
<p>$$
P_1 = (C_1 \oplus C_2) \oplus P_2
$$</p>
<h2>Code sketch</h2>
<pre><code class="language-python">def xor_bytes(a, b):
    return bytes(x ^ y for x, y in zip(a, b))

c1 = bytes.fromhex(&quot;4b1f...&quot;)
c2 = bytes.fromhex(&quot;5a3a...&quot;)
leak = xor_bytes(c1, c2)
</code></pre>
<h2>Table snapshot</h2>
<table>
<thead>
<tr>
<th>Step</th>
<th>Goal</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr>
<td>XOR ciphertexts</td>
<td>Remove key</td>
<td>$P_1 \oplus P_2$</td>
</tr>
<tr>
<td>Guess word</td>
<td>Recover segment</td>
<td>Partial plaintext</td>
</tr>
<tr>
<td>Iterate</td>
<td>Expand context</td>
<td>Full flag</td>
</tr>
</tbody>
</table>

  </div>
</article>

    </main>
  </body>
</html>
